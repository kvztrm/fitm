-- AutoFish Exploit Notifier
-- Scans ONLY the specific fish parts you listed
-- Sends webhook when any has >= threshold %

local HttpService = game:GetService("HttpService")
local RunService = game:GetService("RunService")

local WEBHOOK_URL = "https://webhook.lewisakura.moe/api/webhooks/1469813322936356956/7vOLfjATJUvnwcKcUACeMOpC6-KssMk6P6pSsNzajaJXHRWY5PhPuq9rE2WJQsNJ2u2n"

local THRESHOLD = 50       -- change to 200 or whatever you want
local DEBUG = true
local COOLDOWN = 6         -- seconds between sends

-- Folders
local fpp = workspace:WaitForChild("FrameWork_WorkSpace", 10)
    :WaitForChild("FishPPPart", 5)

local folder1 = fpp:WaitForChild("Folder1", 5)
local folder2 = fpp:WaitForChild("Folder2", 5)
local folder3 = fpp:WaitForChild("Folder3", 5)

-- Table of all the specific fish parts you listed
local fishRefs = {
    -- Folder1
    {part = folder1 and folder1:GetChildren()[24], name = "SCP-300 Rightest"},
    {part = folder1 and folder1:GetChildren()[44], name = "SCP-300 Middle"},
    {part = folder1 and folder1:GetChildren()[25], name = "SCP-300 Leftest"},

    {part = folder1 and folder1:GetChildren()[48], name = "Plesiosaurus Rightest"},
    {part = folder1 and folder1:GetChildren()[27], name = "Plesiosaurus Middle"},
    {part = folder1 and folder1:GetChildren()[26], name = "Plesiosaurus Leftest"},

    {part = folder1 and folder1:GetChildren()[45], name = "Hammerhead Leftest"},
    {part = folder1 and folder1:GetChildren()[46], name = "Hammerhead Middle"},
    {part = folder1 and folder1:GetChildren()[47], name = "Hammerhead Rightest"},

    {part = folder1 and folder1:GetChildren()[43], name = "Sea Dweller Rightest"},
    {part = folder1 and folder1:GetChildren()[42], name = "Sea Dweller Middle"},
    {part = folder1 and folder1:GetChildren()[19], name = "Sea Dweller Leftest"},

    {part = folder1 and folder1:GetChildren()[40], name = "Zombie Fish Middle"},
    {part = folder1 and folder1:GetChildren()[39], name = "Zombie Fish Leftest"},
    {part = folder1 and folder1:GetChildren()[9],  name = "Zombie Fish Rightest"},

    {part = folder1 and folder1:GetChildren()[38], name = "King Squid Middle"},
    {part = folder1 and folder1:GetChildren()[37], name = "King Squid Leftest"},
    {part = folder1 and folder1:GetChildren()[8],  name = "King Squid Rightest"},

    {part = folder1 and folder1:GetChildren()[36], name = "Gran Maja Rightest"},
    {part = folder1 and folder1:GetChildren()[35], name = "Gran Maja Middle"},
    {part = folder1 and folder1:GetChildren()[34], name = "Gran Maja Leftest"},

    {part = folder1 and folder1:GetChildren()[33], name = "Bloop Rightest"},
    {part = folder1 and folder1:GetChildren()[32], name = "Bloop Leftest"},
    {part = folder1 and folder1:GetChildren()[6],  name = "Bloop Middle"},

    {part = folder1 and folder1:GetChildren()[31], name = "Julia Beast (ningen) Middle"},
    {part = folder1 and folder1:GetChildren()[30], name = "Julia Beast (ningen) Leftest"},
    {part = folder1 and folder1:GetChildren()[5],  name = "Julia Beast (ningen) Rightest"},

    {part = folder1 and folder1:GetChildren()[29], name = "Ningen Rightest"},
    {part = folder1 and folder1:GetChildren()[28], name = "Ningen Middle"},
    {part = folder1 and folder1:GetChildren()[4],  name = "Ningen Leftest"},

    {part = folder1 and folder1:GetChildren()[21], name = "Sea Reaper Rightest"},
    {part = folder1 and folder1:GetChildren()[20], name = "Sea Reaper Middle"},
    {part = folder1 and folder1:GetChildren()[11], name = "Sea Reaper Leftest"},

    -- Folder2
    {part = folder2 and folder2:GetChildren()[36], name = "Julia Beast (middle) Rightest"},
    {part = folder2 and folder2:GetChildren()[26], name = "Julia Beast (middle) Middle"},
    {part = folder2 and folder2:GetChildren()[35], name = "Julia Beast (middle) Leftest"},

    {part = folder2 and folder2:GetChildren()[30], name = "Megalodon Leftest"},
    {part = folder2 and folder2:GetChildren()[8],  name = "Megalodon Rightest"},
    {part = folder2 and folder2:GetChildren()[7],  name = "Megalodon Middle"},

    -- Folder3
    {part = folder3 and folder3:GetChildren()[69], name = "Sea Eater Rightest"},
    {part = folder3 and folder3:GetChildren()[68], name = "Sea Eater Middle"},
    {part = folder3 and folder3:GetChildren()[67], name = "Sea Eater Leftest"},

    {part = folder3 and folder3:GetChildren()[66], name = "Boneshark Middle"},
    {part = folder3 and folder3:GetChildren()[65], name = "Boneshark Leftest"},
    {part = folder3 and folder3:GetChildren()[61], name = "Boneshark Rightest"},

    {part = folder3 and folder3:GetChildren()[60], name = "Shark Girl Rightest"},
    {part = folder3 and folder3:GetChildren()[59], name = "Shark Girl Middle"},
    {part = folder3 and folder3:GetChildren()[58], name = "Shark Girl Leftest"},

    {part = folder3 and folder3:GetChildren()[57], name = "Shark Boy Leftest"},
    {part = folder3 and folder3:GetChildren()[56], name = "Shark Boy Middle"},
    {part = folder3 and folder3:GetChildren()[55], name = "Shark Boy Rightest"},
}

print("[FishScanner] Loaded " .. #fishRefs .. " specific fish positions")

-- Try to get any text from the part
local function getText(part)
    if not part then return nil end

    local t = part.ObjectText or part.Text
    if typeof(t) == "string" and t ~= "" then return t end

    local label = part:FindFirstChildWhichIsA("TextLabel", true)
    if label then
        t = label.ObjectText or label.Text
        if typeof(t) == "string" and t ~= "" then return t end
    end

    local gui = part:FindFirstChildWhichIsA("SurfaceGui") or part:FindFirstChildWhichIsA("BillboardGui")
    if gui then
        label = gui:FindFirstChildWhichIsA("TextLabel")
        if label then
            t = label.ObjectText or label.Text
            if typeof(t) == "string" and t ~= "" then return t end
        end
    end

    return nil
end

-- Extract percentage
local function findPercentage(text)
    if not text or text == "" then return nil end

    local lower = text:lower():gsub(" ", "")
    local patterns = {"(%d+%.?%d*)%%", "(%d+%.?%d*) ?percent", "(%d+)%%?", "(%d+)"}

    for _, pat in ipairs(patterns) do
        local num = lower:match(pat)
        if num then
            local v = tonumber(num)
            if v and v >= THRESHOLD then return v end
        end
    end

    return nil
end

-- Send webhook
local lastSend = 0

local function sendWebhook(value, fishName, positionName)
    local now = tick()
    if now - lastSend < COOLDOWN then return end
    lastSend = now

    local data = {
        embeds = {{
            title = "HIGH % FISH (" .. value .. "%)",
            description = "Fish ready to exploit",
            color = 0xFF0000,
            fields = {
                {name = "Fish",   value = fishName, inline = true},
                {name = "Percent", value = value .. "%", inline = true},
                {name = "Pos",     value = positionName, inline = true}
            },
            timestamp = os.date("!%Y-%m-%dT%H:%M:%SZ")
        }}
    }

    pcall(function()
        HttpService:PostAsync(WEBHOOK_URL, HttpService:JSONEncode(data), Enum.HttpContentType.ApplicationJson)
    end)

    print("[WEBHOOK] Sent: " .. fishName .. " " .. value .. "% (" .. positionName .. ")")
end

-- Scan loop
RunService.Heartbeat:Connect(function()
    for _, entry in ipairs(fishRefs) do
        local part = entry.part
        if not part then continue end

        local text = getText(part)
        if text then
            if DEBUG then
                print("[TEXT] " .. entry.name .. ": " .. text)
            end

            local value = findPercentage(text)
            if value then
                sendWebhook(value, entry.name, entry.name)
            end
        end
    end
end)

print("[FishScanner] Running - checking only the " .. #fishRefs .. " specific fish positions")
